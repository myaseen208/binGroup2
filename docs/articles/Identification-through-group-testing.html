<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Identification-through-group-testing • binGroup2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Identification-through-group-testing">
<meta property="og:description" content="binGroup2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Identification-through-group-testing.html">Identification-through-group-testing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Identification-through-group-testing</h1>
            
      
      
      <div class="hidden name"><code>Identification-through-group-testing.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(binGroup2)</span></code></pre></div>
<p>We provide a few examples here showing how to use
<code>binGroup2</code> for the identification aspect of group testing.
More in-depth examples are available in Bilder et al. (2023), which has
been tentatively accepted by the <em>R Journal</em> at the time of
writing this vignette. For further information on group testing, please
see <a href="https://www.chrisbilder.com/grouptesting/" class="external-link">www.chrisbilder.com/grouptesting</a>.
This website also includes the most recent version of Bilder et
al. (2023).</p>
<div class="section level2">
<h2 id="operating-characteristics">Operating characteristics<a class="anchor" aria-label="anchor" href="#operating-characteristics"></a>
</h2>
<p>The <code><a href="../reference/operatingCharacteristics1.html">opChar1()</a></code> and <code><a href="../reference/operatingCharacteristics2.html">opChar2()</a></code> functions
compute operating characteristics, such as the expected number of tests,
for a group testing algorithm. Below is an example of how
<code><a href="../reference/operatingCharacteristics1.html">opChar1()</a></code> can be used for two-stage hierarchical testing
(also known as Dorfman testing) with a one-infection assay. In this
example, we use an overall prevalence of 0.01, a sensitivity and
specificity of 0.99 at each stage, and an initial group size of 10.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Group membership matrix</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="er">&gt;</span> group.member <span class="ot">&lt;-</span> <span class="fu">GroupMembershipMatrix</span>(<span class="at">stage1 =</span> <span class="dv">10</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="sc">&gt;</span> group.member</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; [1,]    1    1    1    1    1    1    1    1    1     1</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; [2,]    1    2    3    4    5    6    7    8    9    10</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Compute operating characteristics for a one-infection assay</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="er">&gt;</span> save1 <span class="ot">&lt;-</span> <span class="fu">opChar1</span>(<span class="at">algorithm =</span> <span class="st">"D2"</span>, <span class="at">p =</span> <span class="fl">0.01</span>, <span class="at">Se =</span> <span class="fl">0.99</span>, <span class="at">Sp =</span> <span class="fl">0.99</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>     <span class="at">hier.config =</span> group.member, <span class="at">print.time =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">names</span>(save1)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; [1] "algorithm" "prob"      "Se"        "Sp"        "Config"    "p.vec"    </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; [7] "ET"        "value"     "Accuracy"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(save1)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Algorithm: Non-informative two-stage hierarchical testing </span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; Testing configuration:</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; Stage 1: 10</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; Expected number of tests: 2.04</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; Expected number of tests per individual: 0.2037</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; Accuracy for individuals:</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;      PSe    PSp   PPPV   PNPV Individuals</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 1 0.9801 0.9991 0.9127 0.9998         All</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; Overall accuracy of the algorithm:</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt;      PSe    PSp   PPPV   PNPV</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 1 0.9801 0.9991 0.9127 0.9998</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; PSe denotes the pooling sensitivity.</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; PSp denotes the pooling specificity.</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; PPPV denotes the pooling positive predictive value.</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; PNPV denotes the pooling negative predictive value.</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ExpTests</span>(save1)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt;   ExpTests ExpTestsPerIndividual PercentReductionTests PercentIncreaseTestCap</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; 1   2.0371                0.2037                 79.63                 390.90</span></span></code></pre></div>
<p>The group membership matrix shows that each individual is tested in
group 1 for the first stage. If this group tests positive, each
individual is tested separately in the second stage. The
<code><a href="../reference/operatingCharacteristics1.html">opChar1()</a></code> function returns its calculations in a list
object that is then summarized by <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. For example,
the expected number of tests is 2.04 for this group. Additional
functions, like <code><a href="../reference/ExpTests.html">ExpTests()</a></code>, can access the information
available in objects created by <code><a href="../reference/operatingCharacteristics1.html">opChar1()</a></code> as well.</p>
<p>The <code><a href="../reference/operatingCharacteristics2.html">opChar2()</a></code> function performs very similar
calculations but for two-infection assays. Below is an example using
two-stage hierarchical testing again. Because there are two infections,
a vector of joint probabilities is specified in the form <span class="math inline">\((p_{--},p_{+-},p_{-+},p_{++})\)</span>, where
<span class="math inline">\(p_{ab}\)</span> is the probability of being
positive/negative <span class="math inline">\((+/-)\)</span> for
infections <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. We continue using a sensitivity and
specificity of 0.99 at each stage and an initial group size of 10.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Compute operating characteristics for a two-infection assay</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="er">&gt;</span> save2 <span class="ot">&lt;-</span> <span class="fu">opChar2</span>(<span class="at">algorithm =</span> <span class="st">"D2"</span>, <span class="at">p.vec =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>     <span class="at">Se =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.99</span>), <span class="at">Sp =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.99</span>), <span class="at">hier.config =</span> group.member,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>     <span class="at">print.time =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">names</span>(save2)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [1] "algorithm" "prob.vec"  "Se"        "Sp"        "Config"    "p.mat"    </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; [7] "ET"        "value"     "Accuracy"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(save2)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; Algorithm: Non-informative two-stage hierarchical testing </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Testing configuration:</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Stage 1: 10</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; Expected number of tests: 5.10</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Expected number of tests per individual: 0.5104</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; Disease 1 accuracy for individuals:</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;      PSe    PSp   PPPV   PNPV Individuals</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 1 0.9850 0.9961 0.8859 0.9995         All</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; Disease 2 accuracy for individuals:</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt;      PSe    PSp   PPPV   PNPV Individuals</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; 1 0.9850 0.9961 0.8859 0.9995         All</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; Overall accuracy of the algorithm:</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt;      PSe    PSp   PPPV   PNPV</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; 1 0.9850 0.9961 0.8859 0.9995</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; 2 0.9850 0.9961 0.8859 0.9995</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; PSe denotes the pooling sensitivity.</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; PSp denotes the pooling specificity.</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; PPPV denotes the pooling positive predictive value.</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; PNPV denotes the pooling negative predictive value.</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ExpTests</span>(save2)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;   ExpTests ExpTestsPerIndividual PercentReductionTests PercentIncreaseTestCap</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; 1   5.1042                0.5104                 48.96                  95.92</span></span></code></pre></div>
<p>The expected number of tests is 5.10 for this testing
configuration.</p>
</div>
<div class="section level2">
<h2 id="optimal-testing-configuration">Optimal testing configuration<a class="anchor" aria-label="anchor" href="#optimal-testing-configuration"></a>
</h2>
<p>The <code><a href="../reference/OTC1.html">OTC1()</a></code> and <code><a href="../reference/OTC2.html">OTC2()</a></code> functions find the
optimal testing configuration for a group testing algorithm. Below is an
example of how <code><a href="../reference/OTC1.html">OTC1()</a></code> can be used for two-stage
hierarchical testing with a one-infection assay. In this example, we
again use an overall prevalence of 0.01 and a sensitivity and
specificity of 0.99 at each stage. The OTC is searched for over group
sizes of 3 to 20.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Find OTC for a one-infection assay</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="er">&gt;</span> save3 <span class="ot">&lt;-</span> <span class="fu">OTC1</span>(<span class="at">algorithm =</span> <span class="st">"D2"</span>, <span class="at">p =</span> <span class="fl">0.01</span>, <span class="at">Se =</span> <span class="fl">0.99</span>, <span class="at">Sp =</span> <span class="fl">0.99</span>, <span class="at">group.sz =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>     <span class="at">obj.fn =</span> <span class="st">"ET"</span>, <span class="at">print.time =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 3</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 4</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 5</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 6</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 7</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 8</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 9</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 10</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 11</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 12</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 13</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 14</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 15</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 16</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 17</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 18</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 19</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 20</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">names</span>(save3)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; [1] "algorithm" "prob"      "Se"        "Sp"        "opt.ET"    "Configs"  </span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; [7] "group.sz"</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(save3)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; Algorithm: Non-informative two-stage hierarchical testing </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; Optimal testing configuration:</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;    Stage 1</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; ET      11</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; Expected number of tests:</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;    E(T)  Value</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; ET 2.24 0.2035</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; E(T) denotes the expected number of tests.</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; Value denotes the objective function value per individual.</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Overall accuracy of the algorithm:</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;       PSe    PSp   PPPV   PNPV</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; ET 0.9801 0.9990 0.9052 0.9998</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; PSe denotes the pooling sensitivity.</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; PSp denotes the pooling specificity.</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; PPPV denotes the pooling positive predictive value.</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; PNPV denotes the pooling negative predictive value.</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">Config</span>(save3)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt;    I     ET  value    PSe    PSp   PPPV   PNPV</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; 1 11 2.2383 0.2035 0.9801 0.9990 0.9052 0.9998</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; 2 10 2.0371 0.2037 0.9801 0.9991 0.9127 0.9998</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; 3 12 2.4561 0.2047 0.9801 0.9989 0.8979 0.9998</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; 4  9 1.8528 0.2059 0.9801 0.9991 0.9203 0.9998</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; 5 13 2.6904 0.2070 0.9801 0.9988 0.8908 0.9998</span></span></code></pre></div>
<p>The OTC has a group size of 11 with an expected number of tests per
individual of 0.2035. This testing configuration is slightly more
efficient than using a group size of 10 as specified in our previous
example. This can be seen by comparing the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
outputs or from the <code><a href="../reference/Config.html">Config()</a></code> function results which
accesses information stored in <code>save3</code>.</p>
<p>The <code><a href="../reference/OTC2.html">OTC2()</a></code> function works in much the same way as
<code><a href="../reference/OTC1.html">OTC1()</a></code> with the main difference being the specification of
joint probabilities rather a single-infection prevalence. In the example
below, we search for the OTC over group sizes of 3 to 20 when using a
two-stage hierarchical testing algorithm.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Find OTC for a two-infection assay</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="er">&gt;</span> save4 <span class="ot">&lt;-</span> <span class="fu">OTC2</span>(<span class="at">algorithm =</span> <span class="st">"D2"</span>, <span class="at">p.vec =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>     <span class="at">Se =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.99</span>), <span class="at">Sp =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.99</span>), <span class="at">group.sz =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">obj.fn =</span> <span class="st">"ET"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>     <span class="at">print.time =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 3</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 4</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 5</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 6</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 7</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 8</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 9</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 10</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 11</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 12</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 13</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 14</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 15</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 16</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 17</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 18</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 19</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; Initial Group Size = 20</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">names</span>(save4)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; [1] "algorithm" "prob.vec"  "Se"        "Sp"        "opt.ET"    "Configs"  </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; [7] "group.sz"</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(save4)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; Algorithm: Non-informative two-stage hierarchical testing </span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Optimal testing configuration:</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt;    Stage 1</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; ET       5</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Expected number of tests:</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt;    E(T)  Value</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; ET 2.20 0.4399</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; E(T) denotes the expected number of tests.</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; Value denotes the objective function value per individual.</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; Overall accuracy of the algorithm:</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;      PSe    PSp   PPPV   PNPV</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; 1 0.9842 0.9978 0.9336 0.9995</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 2 0.9842 0.9978 0.9336 0.9995</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; PSe denotes the pooling sensitivity.</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; PSp denotes the pooling specificity.</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; PPPV denotes the pooling positive predictive value.</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; PNPV denotes the pooling negative predictive value.</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">Config</span>(save4)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt;   I     ET  value   PSe1   PSp1  PPPV1  PNPV1   PSe2   PSp2  PPPV2  PNPV2</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; 1 5 2.1996 0.4399 0.9842 0.9978 0.9336 0.9995 0.9842 0.9978 0.9336 0.9995</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; 2 6 2.6655 0.4443 0.9843 0.9974 0.9226 0.9995 0.9843 0.9974 0.9226 0.9995</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; 3 4 1.8012 0.4503 0.9840 0.9982 0.9454 0.9995 0.9840 0.9982 0.9454 0.9995</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; 4 7 3.1937 0.4562 0.9845 0.9971 0.9124 0.9995 0.9845 0.9971 0.9124 0.9995</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; 5 8 3.7791 0.4724 0.9847 0.9967 0.9029 0.9995 0.9847 0.9967 0.9029 0.9995</span></span></code></pre></div>
<p>The OTC has a group size of 5 with an expected number of tests per
individual of 0.4399. To determine how much more efficient the OTC is in
comparison to our previous two-infection example’s use of a group size
of 10, we use the <code><a href="../reference/CompareConfig.html">CompareConfig()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Compare testing configurations</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="er">&gt;</span> group.member.OTC <span class="ot">&lt;-</span> <span class="fu">GroupMembershipMatrix</span>(<span class="at">stage1 =</span> <span class="dv">5</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="sc">&gt;</span> save5 <span class="ot">&lt;-</span> <span class="fu">opChar2</span>(<span class="at">algorithm =</span> <span class="st">"D2"</span>, <span class="at">p.vec =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>     <span class="at">Se =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.99</span>), <span class="at">Sp =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.99</span>), <span class="at">hier.config =</span> group.member.OTC,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>     <span class="at">print.time =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">CompareConfig</span>(save2, save5)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; Testing configurations compared to individual testing: </span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt;   ExpTests ExpTestsPerIndividual PercentReductionTests PercentIncreaseTestCap</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; 1   5.1042                0.5104                 48.96                  95.92</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; 2   2.1996                0.4399                 56.01                 127.31</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; Percent reduction in tests when using the second testing</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;      configuration rather than the first: 13.81 </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; Percent increase in testing capacity when using the second testing</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt;      configuration rather than the first: 16.02</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>The OTC is 13.81% more efficient than using a group size of 10.</p>
<p>This vignette focuses on a two-stage hierarchical testing algorithm
in a homogeneous population. Many other group testing algorithms are
available! We provide a large number of examples within the help for the
package to illustrate these other algorithms. Our Bilder et al. (2023)
paper also provides many examples. In particular, the appendix of the
paper provides more advanced uses of functions in the package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Brianna Hitt, Christopher Bilder, Frank Schaarschmidt, Brad Biggerstaff, Christopher McMahan, Joshua Tebbs.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
