<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Probability mass function for halving — halving • binGroup2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Probability mass function for halving — halving"><meta property="og:description" content="Calculate the probability mass function for the number of tests
from using the halving algorithm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup2</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>

    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-file-o"></span>

    Vignette

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Identification-through-group-testing.html">Vignette</a>
    </li>
    <li>
      <a href="../articles/binGroup2_Functions.pdf">Functions</a>
    </li>
    <li>
      <a href="../articles/binGroup2_Documentation.pdf">Documentation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>

    News
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/myaseen208/binGroup2" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
<li>
  <a href="https://www.chrisbilder.com/" class="external-link">RG</a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>

    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Probability mass function for halving</h1>

    <div class="hidden name"><code>halving.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the probability mass function for the number of tests
from using the halving algorithm.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">halving</span><span class="op">(</span><span class="va">p</span>, Se <span class="op">=</span> <span class="fl">1</span>, Sp <span class="op">=</span> <span class="fl">1</span>, stages <span class="op">=</span> <span class="fl">2</span>, order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>a vector of individual risk probabilities.</p></dd>


<dt id="arg-se">Se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>sensitivity of the diagnostic test.</p></dd>


<dt id="arg-sp">Sp<a class="anchor" aria-label="anchor" href="#arg-sp"></a></dt>
<dd><p>specificity of the diagnostic test.</p></dd>


<dt id="arg-stages">stages<a class="anchor" aria-label="anchor" href="#arg-stages"></a></dt>
<dd><p>the number of stages for the halving algorithm.</p></dd>


<dt id="arg-order-p">order.p<a class="anchor" aria-label="anchor" href="#arg-order-p"></a></dt>
<dd><p>logical; if TRUE, the vector of individual risk probabilities
will be sorted.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p>
<dl><dt>pmf</dt>
<dd><p>the probability mass function for the halving algorithm.</p></dd>

<dt>et</dt>
<dd><p>the expected testing expenditure for the halving algorithm.</p></dd>

<dt>vt</dt>
<dd><p>the variance of the testing expenditure for the halving
          algorithm.</p></dd>

<dt>p</dt>
<dd><p>a vector containing the probabilities of positivity for each individual.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Halving algorithms involve successively splitting a positive
testing group into two equal-sized halves (or as close to equal as possible)
until all individuals have been identified as positive or negative.
\(S\)-stage halving begins by testing the whole group of \(I\)
individuals. Positive groups are split in half until the final stage of the
algorithm, which consists of individual testing. For example, consider an
initial group of size \(I=16\) individuals. Three-stage halving (3H)
begins by testing the whole group of 16 individuals. If this group tests
positive, the second stage involves splitting into two groups of size 8.
If either of these groups test positive, a third stage involves testing each
individual rather than halving again. Four-stage halving (4H) would continue
with halving into groups of size 4 before individual testing. Five-stage
halving (5H) would continue with halving into groups of size 2 before
individual testing. 3H requires more than 2 individuals, 4H requires more
than 4 individuals, and 5H requires more than 8 individuals.</p>
<p>This function calculates the probability mass function, expected testing
expenditure, and variance of the testing expenditure for halving algorithms
with 3 to 5 stages.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Black, M., Bilder, C., Tebbs, J. (2012).
“Group testing in heterogeneous populations by using halving algorithms.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>61</b>, 277–290.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="expectOrderBeta.html">expectOrderBeta</a></code> for generating a vector of individual risk
probabilities for informative group testing.</p>
<p>Other operating characteristic functions:
<code><a href="GroupMembershipMatrix.html">GroupMembershipMatrix</a>()</code>,
<code><a href="Sterrett.html">Sterrett</a>()</code>,
<code><a href="TOD.html">TOD</a>()</code>,
<code><a href="operatingCharacteristics1.html">operatingCharacteristics1</a>()</code>,
<code><a href="operatingCharacteristics2.html">operatingCharacteristics2</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>This function was originally written by Michael Black for Black
et al. (2012). The function was obtained from
<a href="http://chrisbilder.com/grouptesting/" class="external-link">http://chrisbilder.com/grouptesting/</a>. Minor modifications have been
made for inclusion of the function in the <code>binGroup2</code> package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Equivalent to Dorfman testing (two-stage hierarchical)</span></span></span>
<span class="r-in"><span><span class="fu">halving</span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">10</span><span class="op">)</span>, Se <span class="op">=</span> <span class="fl">1</span>, Sp <span class="op">=</span> <span class="fl">1</span>, stages <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pmf :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   num.tests prob.tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     0.9044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        11     0.0956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> et :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.956179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vt :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.647514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Halving over three stages; each individual has a</span></span></span>
<span class="r-in"><span><span class="co">#   different probability of being positive</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12895</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="expectOrderBeta.html">expectOrderBeta</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span>, alpha <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">halving</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p.vec</span>, Se <span class="op">=</span> <span class="fl">0.95</span>, Sp <span class="op">=</span> <span class="fl">0.95</span>, stages <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pmf :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   num.tests prob.tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     0.3690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         3     0.0399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        13     0.4624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        23     0.1287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> et :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.459485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vt :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 57.46018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.00813011 0.01281577 0.01672941 0.02032010 0.02376267 0.02715206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.03055215 0.03401377 0.03758344 0.04130894 0.04524401 0.04945382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.05402248 0.05906516 0.06474940 0.07133702 0.07927673 0.08944686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 0.10398454 0.13105154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://statistics.unl.edu/" class="external-link">Brianna Hitt</a>, <a href="https://www.chrisbilder.com/" class="external-link">Christopher Bilder</a>, <a href="https://www.cell.uni-hannover.de/de/frank-schaarschmidt" class="external-link">Frank Schaarschmidt</a>, <a href="https://vetmedbiosci.colostate.edu/cvid/" class="external-link">Brad Biggerstaff</a>, <a href="https://www.clemson.edu/science/academics/departments/mathstat/about/profiles/mcmaha2" class="external-link">Christopher McMahan</a>, <a href="https://people.stat.sc.edu/tebbs/" class="external-link">Joshua Tebbs</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: 'bdafb7ea4490644e670f470ee3ef537f',
    indexName: 'binGroup2',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

