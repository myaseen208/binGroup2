<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power to reject a hypothesis for one proportion in group testing — gtPower • binGroup2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power to reject a hypothesis for one proportion in group testing — gtPower"><meta property="og:description" content="This function calculates the power to reject a hypothesis
in a group testing experiment, using confidence intervals for the
decision. This function also calculates the bias of the point estimator
for a given \(n\), \(s\), and true, unknown proportion."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Identification-through-group-testing.html">Identification-through-group-testing</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power to reject a hypothesis for one proportion in group testing</h1>
    
    <div class="hidden name"><code>gtPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates the power to reject a hypothesis
in a group testing experiment, using confidence intervals for the
decision. This function also calculates the bias of the point estimator
for a given \(n\), \(s\), and true, unknown proportion.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gtPower</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">s</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">p.hyp</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"CP"</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>integer specifying the number of groups. A vector of integers is
also allowed.</p></dd>


<dt>s</dt>
<dd><p>integer specifying the common group size. A vector of integers is
also allowed.</p></dd>


<dt>delta</dt>
<dd><p>the absolute difference between the true proportion and the
hypothesized proportion. A vector is also allowed.</p></dd>


<dt>p.hyp</dt>
<dd><p>the proportion in the hypotheses, specified as a value between
0 and 1.</p></dd>


<dt>conf.level</dt>
<dd><p>confidence level required for the decision on the
hypotheses.</p></dd>


<dt>method</dt>
<dd><p>character string specifying the confidence interval method
(see <code><a href="propCI.html">propCI</a></code>) to be used.</p></dd>


<dt>alternative</dt>
<dd><p>character string defining the alternative hypothesis,
either <kbd>"two.sided"</kbd>, <kbd>"less"</kbd>, or <kbd>"greater"</kbd>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix containing the following columns:</p>
<dl><dt>ns</dt>
<dd><p>a vector of the total sample size, \(n*s\).</p></dd>

<dt>n</dt>
<dd><p>a vector of the number of groups.</p></dd>

<dt>s</dt>
<dd><p>a vector of the group sizes.</p></dd>

<dt>delta</dt>
<dd><p>a vector of the delta values.</p></dd>

<dt>power</dt>
<dd><p>the power to reject the given null hypothesis.</p></dd>

<dt>bias</dt>
<dd><p>the bias of the estimator for the specified
\(n\), \(s\), and the true proportion.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The power of a hypothesis test performed by a confidence
interval is defined as the probability that a confidence interval
excludes the threshold parameter (<kbd>p.hyp</kbd>) of the null hypothesis,
as described in Schaarschmidt (2007). Due to discreteness, the power
does not increase monotonically for an increasing number of groups \(n\)
or group size \(s\), but exhibits local maxima and minima, depending
on \(n\), \(s\), <kbd>p.hyp</kbd>, and <kbd>conf.level</kbd>.</p>
<p>Additional to the power, the bias of the point estimator is calculated
according to Swallow (1985). If vectors are specified for \(n\),
\(s\), and (or) delta, a matrix will be constructed and power and
bias are calculated for each line in this matrix.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Schaarschmidt, F. (2007).
“Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing.”
<em>Communications in Biometry and Crop Science</em>, <b>2</b>, 32--40.
ISSN 1896-0782.</p>
<p>Swallow, W. (1985).
“Group testing for estimating infection rates and probabilities of disease transmission.”
<em>Phytopathology</em>, <b>75</b>, 882--889.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="propCI.html">propCI</a></code> for confidence intervals and
<code><a href="gtTest.html">gtTest</a></code> for hypothesis tests for one proportion from a
group testing experiment.</p>
<p>Other estimation functions: 
<code><a href="designEst.html">designEst</a>()</code>,
<code><a href="designPower.html">designPower</a>()</code>,
<code><a href="gtTest.html">gtTest</a>()</code>,
<code><a href="gtWidth.html">gtWidth</a>()</code>,
<code><a href="propCI.html">propCI</a>()</code>,
<code><a href="propDiffCI.html">propDiffCI</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>This function was originally written as <code>bgtPower</code> by Frank
Schaarschmidt for the <code>binGroup</code> package. Minor modifications have
been made for inclusion of the function in the <code>binGroup2</code> package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calculate the power for the design</span></span></span>
<span class="r-in"><span><span class="co">#   in the example given in Tebbs and Bilder(2004):</span></span></span>
<span class="r-in"><span><span class="co">#   n=24 groups each containing 7 insects</span></span></span>
<span class="r-in"><span><span class="co">#   if the true proportion of virus vectors</span></span></span>
<span class="r-in"><span><span class="co">#   in the population is 0.04 (4 percent),</span></span></span>
<span class="r-in"><span><span class="co">#   the power to reject H0: p&gt;=0.1 using an</span></span></span>
<span class="r-in"><span><span class="co">#   upper Clopper-Pearson ("CP") confidence interval</span></span></span>
<span class="r-in"><span><span class="co">#   is calculated with the following call:</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">24</span>, s <span class="op">=</span> <span class="fl">7</span>, delta <span class="op">=</span> <span class="fl">0.06</span>, p.hyp <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        conf.level <span class="op">=</span> <span class="fl">0.95</span>, alternative <span class="op">=</span> <span class="st">"less"</span>,</span></span>
<span class="r-in"><span>        method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ns  n s delta     power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n 168 24 7  0.06 0.8821248 0.0008405368</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Explore development of power and bias for varying n,</span></span></span>
<span class="r-in"><span><span class="co">#   s, and delta. How much can we decrease the number of</span></span></span>
<span class="r-in"><span><span class="co">#   groups (costly tests to be performed) by pooling the</span></span></span>
<span class="r-in"><span><span class="co">#   same number of 320 individuals to groups of</span></span></span>
<span class="r-in"><span><span class="co">#   increasing size without largely decreasing power?</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">320</span>, <span class="fl">160</span>, <span class="fl">80</span>, <span class="fl">64</span>, <span class="fl">40</span>, <span class="fl">32</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">16</span>, <span class="fl">32</span>, <span class="fl">64</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        delta <span class="op">=</span> <span class="fl">0.01</span>,  p.hyp <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ns   n  s delta       power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 320 320  1  0.01 0.169575200 2.428613e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 320 160  2  0.01 0.153984506 4.775749e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 320  80  4  0.01 0.171809348 1.485202e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 320  64  5  0.01 0.172465973 2.017053e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 320  40  8  0.01 0.138488643 3.737105e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 320  32 10  0.01 0.175933578 4.999685e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 320  20 16  0.01 0.102452816 9.486069e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 320  10 32  0.01 0.062895913 1.090916e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 320   5 64  0.01 0.001819794 4.455608e-01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># What happens to the power for increasing differences</span></span></span>
<span class="r-in"><span><span class="co">#   between the true proportion and the threshold</span></span></span>
<span class="r-in"><span><span class="co">#   proportion?</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, s <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>        delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">0.01</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        p.hyp <span class="op">=</span> <span class="fl">0.01</span>, method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ns  n  s delta      power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 500 50 10 0.000 0.02509474 9.556995e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 500 50 10 0.001 0.02045901 1.056338e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 500 50 10 0.002 0.02240288 1.157943e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 500 50 10 0.003 0.03154284 1.260525e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 500 50 10 0.004 0.04988657 1.364095e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 500 50 10 0.005 0.08170390 1.468667e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 500 50 10 0.006 0.13481479 1.574252e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 500 50 10 0.007 0.22262947 1.680863e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 500 50 10 0.008 0.31313453 1.788510e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 500 50 10 0.009 0.37280062 1.897208e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 500 50 10 0.010 0.43351536 2.006969e-04</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate power with a group size of 1 (individual</span></span></span>
<span class="r-in"><span><span class="co">#   testing).</span></span></span>
<span class="r-in"><span><span class="fu">gtPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, s <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">0.01</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        p.hyp <span class="op">=</span> <span class="fl">0.01</span>, method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ns   n s delta        power         bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 100 100 1 0.000 1.837404e-02 1.734723e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 100 100 1 0.001 1.299201e-02 1.908196e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 100 100 1 0.002 8.743140e-03 2.081668e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 100 100 1 0.003 5.525839e-03 2.255141e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 100 100 1 0.004 3.216655e-03 2.602085e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 100 100 1 0.005 1.673268e-03 2.602085e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 100 100 1 0.006 7.394374e-04 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 100 100 1 0.007 2.524704e-04 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 100 100 1 0.008 5.382635e-05 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 100 100 1 0.009 3.631682e-06 3.122502e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 100 100 1 0.010 0.000000e+00 3.469447e-17</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brianna Hitt, Christopher Bilder, Frank Schaarschmidt, Brad Biggerstaff, Christopher McMahan, Joshua Tebbs.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

